#!/bin/bash

# Easy commit script - stages all files and prompts for commit

# Stage all files
git add .

# Get the diff of all changes
changes=$(git diff --staged)

if [ -z "$changes" ]; then
    echo "No changes to commit"
    exit 0
fi

# Show staged changes
echo "=== Staged changes ==="
echo "$changes"
echo ""

# Generate terse, one-line commit message using Claude
echo "Generating commit message..."
commit_msg=$(claude -p "Summarize these git changes into a single terse commit message (max 50 chars, imperative mood, no quotes): $changes" | head -n 1 | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')

# Show generated message
echo ""
echo "Suggested commit message: $commit_msg"
echo ""

# Prompt to commit
echo -n "Commit with this message? (Enter to accept, Ctrl+C to cancel): "
read confirm

# Commit with the message
git commit -m "$commit_msg"
